---
- name: Deploy Docker Compose
  hosts: all
  tasks:
    - name: Update apt cache
      apt:
        update_cache: yes
      become: true

- name: DL Docker
  hosts: all
  tasks:
    - name: Download Docker
      shell: command
      become: true

- name: Install Docker
  hosts: all
  tasks:
    - name: Execute get-docker.sh
      command: sudo sh ./get-docker.sh
      become: true

- name: Copy files to remote host
  hosts: all
  tasks:
    - name: Copy AppNote directory
      copy:
        src: /home/ubuntu/workspace/AppNote
        dest: /home/ubuntu/

- name: Start Docker Compose
  hosts: all
  tasks:
    - name: Run Docker Compose
      command: docker compose up --build -d
      args:
        chdir: /home/ubuntu/AppNote
